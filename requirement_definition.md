# 要件定義

## 概要

秘書として振る舞うClaude Codeエージェントを開発する。
ユーザーのタスク管理や日常の業務をサポートすることを目的とする。

## 振る舞い（ペルソナ）

- **役割**: 優秀な秘書
- **口調**: 丁寧語（です・ます調）。ユーザーを気遣う言葉選びをする。
- **行動指針**: 
    - 指示待ちにならず、必要な情報は自ら提案する。
    - 曖昧な指示は適宜確認するが、推測できる範囲は「〜という理解でよろしいでしょうか」と確認しつつ進める。

## 機能

まずはパイロット版として以下の機能を実装する。

### 1. タスク管理

Notionデータベースを使用してタスクを管理する。

- **タスク取得**: 未完了のタスク一覧を取得し、優先度や期限順に提示する。
- **ステータス更新**: タスクの完了（Done）、進行中（In Progress）などのステータス変更を行う。
- **タスク追加**: 会話の中からタスクを特定し、Notionに新規登録する。

### 2. メモ・記録

- **メモ作成**: ユーザーとの会話内容や重要な決定事項をNotionのメモページ（または指定のデータベース）に保存する。
- **作業ログ**: エージェント自身の作業内容を記録に残す。

## ファイル構成（案）

以下のファイルで構成する。

- `CLAUDE.md`
  - エージェントの振る舞い（システムプロンプト的な役割）、コーディング規約、コマンド等を定義。
- `.claude/`
  - `agents/`: 秘書エージェントの具体的な定義ファイル（プロンプト等）。
  - `mcp-servers/`: MCPサーバー設定ファイル（`claude_mcp_config.json` 等）。
- `mcp-servers/`
  - Notion連携用MCPサーバーのソースコード、またはDocker設定。
  - 基本的には `docker compose` で管理しやすい形にする。
  - NortionのAPIは３リクエスト/秒がレート制限であることに注意
  - PythonのFast MCPをベースに実装する
- `work_logs/` (旧: 作業履歴)
  - `YYYYMMDD/progress.md` の形式でエージェントの活動記録を保存する。
- `scripts/`
  - `start_agent.sh`: MCPサーバーの起動確認〜Claude Code起動を行うスクリプト。

## アーキテクチャ

### Notion MCPサーバー

- **接続方式**: Notion APIを使用。
- **機能**:
    - データベースのクエリ（タスク取得）
    - ページの作成・更新（タスク追加・更新、メモ作成）
- **構成**:
    - 既存のNotion MCPサーバーを利用するか、シンプルなTypeScript/Python製のカスタムサーバーをDockerで動かす。

### 作業記録フロー

1. エージェントが作業を開始・完了するたびに、ローカルの `work_logs` ディレクトリ内の日次ファイルに追記する。
2. 将来的にはこれもNotionに同期することを検討するが、まずはローカルファイルで実装。